
<div class="row">
    <div class="col-xl-3 col-md-6">
        <div class="card" style="background: #313844;" >
            <div class="card-body widget-user">
                
                <div class="float-end" ngbDropdown placement="bottom-end">
                    <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                        <i class="mdi mdi-dots-vertical"></i>
                    </a>
                    <div ngbDropdownMenu>
                        <a href="javascript:void(0);" [routerLink]="['/vitalsList/'+snapshotParam]" ngbDropdownItem>View List</a>
                    </div>
                </div>
                <div class="text-center">
                    <h2 class="fw-normal" style="color: #82B4F3;">{{vitalsCount}}</h2>
                    <h5 style="color: #ADB5BD;">Total Pilots</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card" style="background: #313844;;" >
            <div class="card-body widget-user">
                <div class="float-end" ngbDropdown placement="bottom-end">
                    <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                        <i class="mdi mdi-dots-vertical"></i>
                    </a>
                    <div ngbDropdownMenu>
                        <a href="javascript:void(0);" [routerLink]="['/vitalsList/'+snapshotParam]"  [queryParams]="{ status: 'active'}" ngbDropdownItem>View List</a>
                    </div>
                </div>
                <div class="text-center">
                    <h2 class="fw-normal" style="color: #F08FC9;">{{activePilotsCount}}</h2>
                    <h5 style="color: #ADB5BD;">Active Pilots</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card" style="background: #313844;;" >
            <div class="card-body widget-user">
                <div class="float-end" ngbDropdown placement="bottom-end">
                    <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                    </a>
                </div>
                <div class="text-center">
                    <h2 class="fw-normal" style="color: #F2CA65;">{{totalTests}}</h2>
                    <h5 style="color: #ADB5BD;">Total Tests</h5>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card" style="background: #313844;;" >
            <div class="card-body widget-user">
                <div class="float-end" ngbDropdown placement="bottom-end">
                    <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                    </a>
                </div>
                <div class="text-center">
                    <h2 class="fw-normal" style="color: #FF9632;">0</h2>
                    <h5 style="color: #ADB5BD;">Won</h5>
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="card" style="background: #313844;">
        <div class="card-body">
            <div class=" float-end" ngbDropdown placement="bottom-end">
                <a href="javascript:void(0)" class="dropdown-toggle arrow-none card-drop" ngbDropdownToggle>
                    <i class="mdi mdi-dots-vertical"></i>
                </a>
                <div ngbDropdownMenu>
                    <a href="javascript:void(0);" [routerLink]="['/vitalsList/'+snapshotParam]" ngbDropdownItem>Pilots List</a>

                </div>
            </div>            
            <h4 class="mt-0 header-title" style="color: white;cursor:pointer"  href="javascript:void(0);" [routerLink]="['/vitalsList/'+snapshotParam]" >Recent 5 Pilots</h4>

            <div class="table-responsive" >
                <table class="table advanced-table table-nowrap mb-0">
                    <thead style=" font-weight: 700;   color: #9BA6AC;     border-color: #9BA6AC;">

                        <tr style="border-color: #49565d;">
                            <th>#</th>
                            <th>Org Name</th>
                            <th>Pilot For</th>
                            <th style="    text-align: -webkit-center;">Start Date</th>
                            <th style="    text-align: -webkit-center;">End Date</th>
                            <th style="    text-align: -webkit-center;">Users</th>
                            <th >Status</th>
                            <th style="    text-align: -webkit-center;">Tests</th>
                            
                        </tr>
                    </thead>
                    <tbody style=" font-weight: 400;  color: #9BA6AC;    border-color: #49565d;">
                        <tr class="over-hover" style="border-color: #49565d;"  *ngFor="let person of vitalsDetails;let indexOfelement=index;">
                            <th scope="row">{{indexOfelement+1}}</th>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style="cursor: pointer;">{{person.organization_name}}</td>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style="cursor: pointer;">
                            <div class="">
                    
                                {{person.pilot_duration}} days
                                <ngb-progressbar style="margin-top: 0;" [type]="(person.status =='Expired' ) ? 'danger':'warning'" [value]="(person.status =='Expired' ) ? 100 :(person.pilot_duration-daysLefts(person.end_date) < 0? 0 : person.pilot_duration-daysLefts(person.end_date))" [max]=" (person.status =='Expired' ) ? 100:person.pilot_duration"  class=" progress-bar-alt-warning progress-sm"></ngb-progressbar>
                            </div>
                            </td>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style=" cursor: pointer;   text-align: -webkit-center;">{{person.start_date | date: 'dd/MM/yyyy'}}</td>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style="cursor: pointer;    text-align: -webkit-center;">{{person.end_date | date: 'dd/MM/yyyy'}}</td>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style="cursor: pointer;    text-align: -webkit-center;">{{person.total_users}}</td>
                            <td *ngIf="person.status=='Active'" style="color: green;">{{person.status}}</td>
                            <td *ngIf="person.status=='Expired'" style="color: #F08F8F;" >{{person.status}}</td>
                            <td [routerLink]="['/orgdetails', person.org_id]" href="javascript:void(0);" style="cursor: pointer;    text-align: -webkit-center;color: #F2CA65;">{{person.total_tests}}</td>
                        </tr>                     
                    </tbody>
                </table>
            </div>
        </div>

    </div>
    <div class="card" style="background: #313844;">
        <div class="card-body">
            <div class=" float-end" ngbDropdown placement="bottom-end">
                <a href="javascript:void(0)" class="dropdown-toggle arrow-none card-drop" ngbDropdownToggle>
                    <i class="mdi mdi-dots-vertical"></i>
                </a>
                <div ngbDropdownMenu>
                    <a href="javascript:void(0);" [routerLink]="['/guestlist/'+snapshotParam]" ngbDropdownItem>Guest List </a>

                </div>
            </div>            
            <h4 class="mt-0 header-title" style="color: white;cursor:pointer "  href="javascript:void(0);" [routerLink]="['/guestlist/'+snapshotParam]">Recent 5 Guest Scans</h4>

            <div class="table-responsive" >
                <table class="table advanced-table table-nowrap mb-0">
                    <thead style=" font-weight: 700;   color: #9BA6AC;     border-color: #9BA6AC;">

                        <tr style="border-color: #49565d;text-align:center">
                            <th>#</th>
                            <th>Name</th>
                            <th>Age</th>
                            <th style="    text-align: -webkit-center;">Gender</th>
                            <th style="    text-align: -webkit-center;">Email</th>
                            <th style="    text-align: -webkit-center;">First Scan</th>
                            <th >Last Scan</th>
                            <th >Tests</th>
                            <th></th>
                            
                        </tr>
                    </thead>
                    <tbody style=" font-weight: 400;  color: #9BA6AC;    border-color: #49565d;">
                        <tr class="over-hover" style="border-color: #49565d;text-align:center"  *ngFor="let person of guestData;let indexOfelement=index;">
                            <th scope="row">{{indexOfelement+1}}</th>
                            <!-- {{person.id}} -->
                            <td>{{person.name}}</td>
                            <td>{{person.age ? person.age:'NA'}}</td>
                            <td>{{person.gender?person.gender:'NA'}}</td>
                            <td>{{person.email}}</td>
                            <td>{{(person.first_scan| date: 'dd/MM/yyyy')?person.first_scan:'NA'}}</td>
                            <td>{{(person.last_scan| date: 'dd/MM/yyyy')?person.last_scan : 'NA'}}</td>
                            <td style="cursor: pointer;    text-align: -webkit-center;color: #F2CA65;">{{person.total_tests_viu?person.total_tests_viu:'NA'}}</td>
                            <td class="option">
                                <div class=" float-end" ngbDropdown placement="bottom-end" >
                                    <a href="javascript:void(0)" class="dropdown-toggle arrow-none card-drop" ngbDropdownToggle>
                                        <i class="mdi mdi-dots-vertical"></i>
                                    </a>
                                    <div style="    border: 1px solid #4B515F;" ngbDropdownMenu>
                                        <a (click)="enableScan(person.email,person.name,person.attempts)"   href="javascript:void(0);" ngbDropdownItem>Enable Additional Scans</a>
                                        <a *ngIf="person.data.length!=0" (click)="exportexcel(person.data)"  href="javascript:void(0);" ngbDropdownItem>Download Report</a>                            
                            </div>
    
                                </div> 
                            </td>
                        </tr>

                    </tbody>
                </table>
                <div *ngIf="guestData.length === 0"><p style="text-align: -webkit-center;">No Records Found</p></div>
          
            </div>
        </div>

    </div>
    <ng-template #toggleModal6 let-modal>
        <div class="card" style="background-color: #282E38;margin-bottom: 0;">
            <div class="card-body" style="    background-color: #282E38;min-width: min-content;">
                <div class=" float-end" ngbDropdown placement="bottom-end">
                    <a href="javascript:void(0)" class="dropdown-toggle arrow-none card-drop" (click)="modal.dismiss('');reloadCurrentPage()" ngbDropdownToggle>
                        <i class="mdi mdi-close"></i>
                    </a>
                </div>      
                <div *ngIf = "template"   >
                <h4 style="color: white;">Enable Additional Scans</h4>
    
                <div style="    
                border-radius: 6px;
                height: auto;
                width: auto;
                
        padding: 0.5rem;
                background-color: #3C424F   ;">
            <p style="    margin: 0;
            text-align: center;color:#AEB5BC">You are enabling additional scans for </p>
            <p style="    margin: 0;
            text-align: center;color:#FFFFFF">{{user_name}} ({{user_email}})</p>
            </div>
        
                <form>
                    <div id="basicwizard">
    
                        <div class="card">
                            <div class="card-body" style="padding-left: 0;padding-bottom:0">
                                <h4 class="header-title" style="color: #AEB5BC;">How many Additional Scans you want to enable?</h4>
                                <ngx-slider  [(ngModel)]="attempts" [ngModelOptions]="{standalone: true}"
                                    [options]="{
                                        floor: 0,
                                        ceil: 10
                                    }"></ngx-slider>
    
                            </div> 
                        </div> 
                        <ul class="list-inline mb-0 wizard" >
                            <li class="next list-inline-item float-end" *ngIf="activeWizard2 == 1">
                                <button type="button" style="width: 100px;" class="btn btn-info" (click)="guestUpdate()">Submit</button>
                            </li>
                            <li class="next list-inline-item " *ngIf="activeWizard2 == 1">
                                <button type="button" style="width: 100px;" class="btn btn-secondary" (click)="modal.dismiss('')" >Close</button>
                            </li>
                        </ul>
                    </div> 
                </form>
        
            </div>
            <div *ngIf="!template">
                <h4 style="color: white;">Enable Additional Scans</h4>
                    <div class="row">
                        <div class="col-12">
                            <div class="text-center">
                                <h2 class="mt-0"><i class="mdi mdi-check-all" style="color: #fff;"></i></h2>
                                <h3 class="mt-0" style="color: #fff;">Success !</h3>
                                <p style="color: #AEB5BC;" class="w-75 mb-2 mx-auto">You have successfully enabled additional scans for {{user_name}}. A notification email has already been sent to the user.</p>
                                <button type="button" style="width: 100px;" class="btn btn-info mt-3" (click)="modal.dismiss('');reloadCurrentPage();" >Close</button>
                            </div>
                        </div>
                    </div> 
            </div>
        </div>      
        </div> 
    </ng-template>